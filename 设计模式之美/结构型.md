## 结构型的几种模式

一对一关系的：代理模式和装饰器模式。

一对二关系的：适配器模式

一

## 代理模式

使用场景：对一个类进行与原功能无关的附加功能的添加。

栗子：数据库类加日志和计时功能。

存在的意义和解决的问题：将添加的功能和原有类进行解耦。

标准实现：

1. 代理类和被代理类实现相同接口（不行还可以考虑继承代理类）
2. 代理类持有一个被代理类的实例，在对应的方法内添加需要添加的功能以后再调用被代理类。

#### java动态代理

Java提供了`InvokeHandler`的动态代理的API，让我们可以直接使用，不用依次实现每个被代理类的方法，插入想要添加的逻辑。



## 装饰器模式

使用场景：对一个类进行与原功能有关的附加功能的添加。

栗子：相片和相框，相框是对相片功能的一种增强，增加了方便展示、耐脏等功能，两者是组合关系，相框组合了相片。

存在的意义和解决的问题：解决继承关系过于复杂的问题。

标准实现：

1. 装饰器和被装饰器继承相同的父类，这样只需实现增强的方法，其余方法直接用父类的即可。

2. 在构造方法中可以接收一个父类对象作为业务的被委托类，业务方法委托给被委托类的同时做自己的功能增强

3. 同时如果有多个装饰器，可以多次嵌套，用起来的的效果就是Java的InputStream的一些子类装饰器的用法：

   ```java
   InputStream in = new FileInputStream("/user/test.txt");
   InputStream bin = new BufferedInputStream(in);
   DataInputStream din = new DataInputStream(bin);
   int data = din.readInt();
   ```



## 适配器模式

使用场景：将不兼容的接口转换为可兼容的接口，让原本由于接口不兼容而不能一起工作的类可以一起工作。

栗子：电源转接器，适配那些规格不一致的电源插座和插头，转接器继承电源插座，组合并且调用电源插头。



## 桥接模式

栗子：汽车的品牌与档位类型这两个变化纬度，通过桥接模式和用组合替代继承的思想来解决继承爆炸的问题。

