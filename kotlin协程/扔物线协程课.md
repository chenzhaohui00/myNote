# 切线程 launch

## CoroutineScope

类比线程池的写法，java线程池：

```kotlin
val excutor = Excutors.newCachedThreadPool()
excutor.excute {
	//runnable的run代码
}
```

协程的CoroutineScope就是类似于线程池的东西，写法：

```kotlin
val scope = CoroutineScoe(EmptyCoroutineContext())
scope.launch {
	//
}
```



## 线程管理： ContinuationInterceptor

ContinuationInterceptor这个接口虽然名字上看就是一个interceptor，但是基本主要用来做线程切换。

这个接口有一个唯一的子类：CoroutineDispatcher。

而在kotlin中常用的几个默认的scope就又继承于CoroutineDispatcher。

### Dispatchers.Main

Android的主线程



### Dispatchers.Default

- 默认的线程池
- 用于CPU密集操作的线程池。
- 线程数为cpu核心线程数



### Dispatchers.IO

- 用于IO操作的线程池。
- 线程数为固定的64 或 cpu核心数(当cpu核心数大于64时)



### 自定义线程池

第一种，普通线程池：

```kotlin
val context = newFixedThreadPoolContext(4, "myPoolContext") //线程数 & name
//使用线程池。。。
...
//关闭线程池
context.close()
```

第二种，单线程线程池：

```kotlin
val singlePoolContext = newSingleThreadContext("singlePoolContext")

//关闭
singlePoolContext.close()
```





### 指定线程/线程池

- 在创建Scope的时候传入

  ```kotlin
  val scope = CoroutineScoe(Dispatchers.IO)
  ```

- 在launch的时候传入

  ```kotlin
  val scope = CoroutineScoe(Dispatchers.IO)
  scope.launch(Dispachers.Main) {
  	//主线程操作逻辑
  }
  ```